# DC 仿真项目结构说明 ## 项目目录结构 ``` Design_Project/ ├── src/ # 核心仿真代码 │ ├── data_preparation.py # 数据提取与准备（从Excel提取7类参数） │ └── dc_simulation.py # DC仿真主程序（SimPy离散事件仿真） │ ├── data/ # 数据文件 │ ├── raw/ # 原始数据文件 │ │ ├── KPI sheet 2025.xlsx # KPI数据（效率、工时） │ │ └── Total Shipments 2025.xlsx # 运输数据（到达率、托盘数） │ │ │ ├── Timeslot by week/ # 码头时间槽数据（48周） │ │ ├── W1.xlsx ~ W48.xlsx # 每周的码头预订和容量数据 │ │ └── ... # （用于提取hourly_dock_capacity） │ │ │ ├── processed/ # 处理后的中间数据 │ │ ├── Timeslot_Analysis_Data_November_2025.xlsx │ │ └── Timeslot_Filtered_Data_November_2025.xlsx │ │ │ ├── Nov_analysis/ # 11月专项分析结果 │ ├── Timeslot_Yearly_Analysis/ # 全年Timeslot分析结果 │ └── Volume_Yearly_Analysis/ # 全年Volume分析结果 │ ├── outputs/ # 所有输出结果 │ ├── simulation_configs/ # 仿真配置文件 │ │ ├── simulation_config.json # JSON格式配置（供仿真程序读取） │ │ └── simulation_parameters.xlsx # Excel格式参数汇总（便于查看） │ │ │ ├── figures/ # 可视化图表 │ │ └── hourly_arrival_pattern.png # 每小时到达分布图 │ │ │ └── results/ # 仿真运行结果 │ ├── simulation_results_comparison.xlsx # 场景对比结果 │ ├── simulation_details_baseline.xlsx # 基准场景详细数据 │ ├── simulation_details_scenario_*.xlsx # 各场景详细数据 │ ├── arrival_buffer_validation_report.txt │ ├── dock_capacity_hourly_analysis.txt │ └── pallet_distribution_report.txt │ ├── scripts/ # 辅助脚本 │ ├── analysis/ # 数据分析脚本 │ │ ├── productivity.py # 生产力分析 │ │ ├── Timeslot.py # Timeslot单月分析 │ │ ├── Timeslot_yearly.py # Timeslot全年分析 │ │ ├── volume.py # Volume单月分析 │ │ └── volume_yearly.py # Volume全年分析 │ │ │ └── debug/ # 调试工具脚本 │ ├── debug_dock_capacity.py │ ├── debug_dock_filter.py │ ├── check_columns.py │ └── check_data.py │ ├── docs/ # 项目文档 │ ├── SIMULATION_MODEL_OVERVIEW.md # 仿真模型总览 │ ├── SIMULATION_MODEL_STRUCTURE.md # 仿真模型结构详解 │ ├── SIMULATION_ANALYSIS.md # 仿真分析结果文档 │ └── archive/ # 历史文档归档 │ ├── doc/ # 原始项目文档 │ ├── Danone Design Project.txt │ └── Belbin_Test/ │ ├── .venv/ # Python虚拟环境 ├── requirements.txt # Python依赖包列表 ├── README.md # 项目主README ├── problems.md # 问题记录 └── PROJECT_STRUCTURE.md # 本文件（项目结构说明） ``` ## 数据流程 ``` 原始数据 (data/raw/) ↓ 数据提取 (src/data_preparation.py) ↓ 仿真配置 (outputs/simulation_configs/) ↓ 仿真运行 (src/dc_simulation.py) ↓ 结果输出 (outputs/results/) ``` ## 提取的7类参数（100%完整度） ### 1. **效率参数** (efficiency) - 来源: `data/raw/KPI sheet 2025.xlsx` - 数据: R&P 5.80±0.37 pal/hr, FG 3.54±0.39 pal/hr ### 2. **工厂生产速率** (factory_production) - 来源: 基于入库需求计算 - 数据: R&P 20.6 pal/hr, FG 42.2 pal/hr ### 3. **缓冲区容量** (buffer_capacity) - 来源: 基于需求估算 - 数据: R&P 4辆挂车, FG 9辆挂车 ### 4. **卡车到达率** (truck_arrival_rates) - 来源: `data/raw/Total Shipments 2025.xlsx` - 数据: 分FG/R&P两类，24小时到达分布 ### 5. **码头容量** (hourly_dock_capacity) ⭐ - 来源: `data/Timeslot by week/W1-W48.xlsx` (48周精确数据) - 提取方法: 参照 `scripts/analysis/Timeslot.py` 逻辑 - 数据: 96个值（FG/R&P × Loading/Reception × 24小时） - 统计: FG Loading平均1.8个码头, R&P Loading平均3.3个码头 ### 6. **托盘数分布** (pallets_distribution) - 来源: `data/raw/Total Shipments 2025.xlsx` - 数据: 33,280批次分析，FG mean=30.0, R&P mean=22.7 ### 7. **人力资源** (fte_total, fte_allocation) - 来源: `data/raw/KPI sheet 2025.xlsx` Hours数据 - 数据: R&P 26人, FG 97人, 总计123人 ## 快速开始 ### 1. 数据准备 ```bash cd src python data_preparation.py ``` 生成配置文件到 `outputs/simulation_configs/` ### 2. 运行仿真 ```bash cd src python dc_simulation.py ``` 结果保存到 `outputs/results/` ### 3. 查看分析脚本 ```bash cd scripts/analysis python Timeslot_yearly.py # 全年Timeslot分析 python volume_yearly.py # 全年Volume分析 ``` ## 核心文件说明 ### src/data_preparation.py - **功能**: 从Excel文件提取全部7类仿真参数 - **输入**: `data/raw/` 中的Excel文件 - **输出**: - `outputs/simulation_configs/simulation_config.json` - `outputs/simulation_configs/simulation_parameters.xlsx` - `outputs/figures/hourly_arrival_pattern.png` - **关键特性**: - 完全按照 `Timeslot.py` 逻辑提取码头容量 - 自动数据验证和清洗 - 智能分布类型识别（triangular/normal） ### src/dc_simulation.py - **功能**: SimPy离散事件仿真DC操作 - **输入**: `outputs/simulation_configs/simulation_config.json` - **输出**: `outputs/results/` 中的Excel和txt文件 - **支持场景**: - Baseline（基准） - Scenario 1-4（优化场景） - 自定义参数场景 ## 调试工具 位于 `scripts/debug/`，用于诊断数据提取问题： - `debug_dock_capacity.py`: 检查码头容量数据结构 - `debug_dock_filter.py`: 验证数据过滤逻辑 - `check_columns.py`: 检查Excel列结构 - `check_data.py`: 查看原始数据样本 ## 分析脚本 位于 `scripts/analysis/`，用于探索性数据分析： - `Timeslot_yearly.py`: 生成全年码头利用率分析和箱线图 - `volume_yearly.py`: 生成全年货量趋势分析 - `productivity.py`: 生产力指标分析 ## 项目目标 通过仿真分析Danone DC的运营效率，评估： 1. 当前资源配置的瓶颈 2. 不同优化场景的效果 3. 码头容量与到达率的匹配度 4. 人力资源的合理配置 ## 更新日志 - **2026-01-09**: - ✅ 完成项目结构重组 - ✅ 实现码头容量精确提取（参照Timeslot.py逻辑） - ✅ 修复FTE提取逻辑错误 - ✅ 实现全部7类参数提取（100%完整度） - ✅ 规范化文件路径和输出位置 ## 联系信息 项目团队: TU Delft Design Project 