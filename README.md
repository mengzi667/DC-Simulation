# Danone DC 仿真项目 > TU Delft Design Project - Distribution Center 运营优化仿真分析 ## 项目概述 本项目使用 **SimPy 离散事件仿真** 分析 Danone 配送中心（DC）的运营效率，通过从真实数据中提取参数，评估不同优化场景的效果。 ### 核心特性 - ✅ **100% 数据驱动**: 全部7类参数从实际Excel数据精确提取 - ✅ **高保真仿真**: 模拟卡车到达、码头装卸、缓冲区管理全流程 - ✅ **多场景对比**: 支持Baseline + 4个优化场景的对比分析 - ✅ **详细输出**: 生成KPI对比表、时序数据、可视化图表 ## 快速开始 ### 环境准备 ```bash # 1. 创建虚拟环境 python -m venv .venv # 2. 激活虚拟环境 # Windows PowerShell: .\.venv\Scripts\Activate.ps1 # 3. 安装依赖 pip install -r requirements.txt ``` ### 运行流程 #### Step 1: 数据准备（提取仿真参数） ```bash cd src python data_preparation.py ``` **输出文件：** - `outputs/simulation_configs/simulation_config.json` - 仿真配置（JSON格式） - `outputs/simulation_configs/simulation_parameters.xlsx` - 参数汇总（Excel格式） - `outputs/figures/hourly_arrival_pattern.png` - 到达分布可视化 **提取的7类参数：** 1. 效率参数（R&P 5.80 pal/hr, FG 3.54 pal/hr） 2. 工厂生产速率（24/7连续生产） 3. 缓冲区容量（R&P 4辆, FG 9辆挂车） 4. 卡车到达率（分类别24小时分布） 5. **码头容量**（48周精确数据，96个值）⭐ 6. 托盘数分布（33,280批次分析） 7. 人力资源（R&P 26人, FG 97人） #### Step 2: 运行仿真 ```bash cd src python dc_simulation.py ``` **输出文件：** - `outputs/results/simulation_results_comparison.xlsx` - 场景对比汇总 - `outputs/results/simulation_details_*.xlsx` - 各场景详细数据 - `outputs/figures/*.png` - 6个KPI对比图表 **仿真场景：** - **Baseline**: 当前配置（基准场景） - **Scenario 1**: 优化到达时间分布 - **Scenario 2**: 增加码头容量 - **Scenario 3**: 优化效率参数 - **Scenario 4**: 综合优化 ## 项目结构 ``` Design_Project/ ├── src/ # 核心代码 │ ├── data_preparation.py # 数据提取（7类参数） │ └── dc_simulation.py # 仿真主程序 │ ├── data/ # 数据文件 │ ├── raw/ # 原始Excel数据 │ │ ├── KPI sheet 2025.xlsx │ │ └── Total Shipments 2025.xlsx │ └── Timeslot by week/ # 48周码头数据（W1-W48.xlsx） │ ├── outputs/ # 所有输出 │ ├── simulation_configs/ # 仿真配置文件 │ ├── figures/ # 可视化图表 │ └── results/ # 仿真结果 │ ├── scripts/ # 辅助脚本 │ ├── analysis/ # 数据分析脚本 │ └── debug/ # 调试工具 │ └── docs/ # 项目文档 ``` 详细结构说明见 [PROJECT_STRUCTURE.md](PROJECT_STRUCTURE.md) ## 关键结果 ### 提取的参数准确性 | 参数类别 | 数据来源 | 样本量 | 状态 | |---------|---------|-------|------| | 效率参数 | KPI sheet | 11个月 | ✅ 完成 | | 到达率 | Total Shipments | 全年 | ✅ 完成 | | 码头容量 | Timeslot W1-W48 | 48周 | ✅ 精确提取 | | 托盘分布 | Total Shipments | 33,280批次 | ✅ 完成 | | 人力资源 | KPI sheet Hours | 11个月 | ✅ 修正完成 | ### 仿真性能指标 - **SLA 达成率**: 目标 >95% - **平均等待时间**: 目标 <30分钟 - **缓冲区溢出**: 目标 0次 - **午夜积压**: 目标 <5辆卡车 ## ️ 技术栈 - **Python 3.11+** - **SimPy**: 离散事件仿真框架 - **Pandas**: 数据处理与分析 - **Matplotlib**: 数据可视化 - **OpenPyXL**: Excel文件读写 ## 文档 - [项目结构说明](PROJECT_STRUCTURE.md) - 完整目录结构和文件说明 - [仿真模型概览](docs/SIMULATION_MODEL_OVERVIEW.md) - 仿真模型设计思路 - [仿真模型结构](docs/SIMULATION_MODEL_STRUCTURE.md) - 详细技术文档 - [仿真分析报告](docs/SIMULATION_ANALYSIS.md) - 结果分析和建议 ## 数据提取方法 ### 码头容量提取（核心创新）⭐ 完全参照 `scripts/analysis/Timeslot.py` 逻辑： 1. 读取48周Timeslot数据（W1-W48.xlsx） 2. 使用openpyxl解析，标准化列数（31/32列） 3. 过滤2025年有效数据（Booking taken + Available Capacity） 4. 按FG/R&P × Loading/Reception × 24小时分组 5. 计算每小时平均容量（总容量 / 天数） **结果：** - FG Loading: 平均 1.8 个码头/小时 - FG Reception: 平均 1.8 个码头/小时 - R&P Loading: 平均 3.3 个码头/小时 - R&P Reception: 平均 1.2 个码头/小时 ## 使用场景 1. **当前状态分析**: 运行Baseline场景，评估现有配置 2. **优化方案评估**: 对比Scenario 1-4，选择最佳优化策略 3. **敏感性分析**: 修改参数，测试不同条件下的表现 4. **容量规划**: 评估码头/人力资源需求 ## 待办事项 - [ ] 集成更多历史数据（2024年数据） - [ ] 添加成本分析模块 - [ ] 实现实时监控仪表板 - [ ] 支持更多自定义场景 ## 贡献 本项目由 TU Delft Design Project 团队开发。 ## 许可 本项目仅用于学术研究目的。 --- **最后更新**: 2026-01-09 **版本**: v2.0 - 完整数据驱动版本 